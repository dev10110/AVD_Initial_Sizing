%% Plot CM_CG vs. CL
% for trim analysis

% house keeping
clear; close all; clc;

% copy-paste data from:
% Athena_calculator/TrimAnsys sheet

%% FROM COLUMNS I,J
% alpha data
data_alpha = [-2	-0.03490658504
-1	-0.01745329252
0	0
1	0.01745329252
2	0.03490658504
3	0.05235987756
4	0.06981317008
5	0.0872664626
6	0.1047197551
7	0.1221730476
8	0.1396263402
9	0.1570796327
10	0.1745329252
11	0.1919862177
12	0.2094395102
13	0.2268928028
14	0.2443460953
15	0.2617993878
16	0.2792526803
17	0.2967059728
18	0.3141592654
19	0.3316125579
20	0.3490658504];
alpha_deg = data_alpha(:,1);
alpha_rad = data_alpha(:,2);

%% FROM COLUMNS K,L
% wing CL and fuselage CM
data_CLCMf = [-0.292804636	-0.126603381
-0.1952030907	-0.0633016905
-0.09760154534	0
0	0.0633016905
0.09760154534	0.126603381
0.1952030907	0.1899050715
0.292804636	0.253206762
0.3904061813	0.3165084525
0.4880077267	0.379810143
0.585609272	0.4431118335
0.6832108174	0.506413524
0.7808123627	0.5697152145
0.878413908	0.633016905
0.9760154534	0.6963185955
1.073616999	0.759620286
1.171218544	0.8229219765
1.268820089	0.886223667
1.366421635	0.9495253575
1.46402318	1.012827048
1.561624725	1.076128739
1.659226271	1.139430429
1.756827816	1.20273212
1.854429361	1.26603381];
CLwing = data_CLCMf(:,1);

%% FROM COLUMNS M ~ AG
labelCLCLCM = [-3,0,3,6,9,12,15];
dataCLCLCM = [-0.3825728918	-0.6753775278	0.2703288868	-0.08557289177	-0.3783775278	0.009043284901	0.2114271082	-0.08137752778	-0.252242317	0.5084271082	0.2156224722	-0.5135279189	0.8054271082	0.5126224722	-0.7748135207	1.102427108	0.8096224722	-1.036099123	1.399427108	1.106622472	-1.297384724
-0.3371597056	-0.5323627963	0.1891242135	-0.04015970562	-0.2353627963	-0.07216138838	0.2568402944	0.06163720371	-0.3334469903	0.5538402944	0.3586372037	-0.5947325921	0.8508402944	0.6556372037	-0.856018194	1.147840294	0.9526372037	-1.117303796	1.444840294	1.249637204	-1.378589398
-0.2917465195	-0.3893480648	0.1079195402	0.005253480522	-0.09234806481	-0.1533660617	0.3022534805	0.2046519352	-0.4146516635	0.5992534805	0.5016519352	-0.6759372654	0.8962534805	0.7986519352	-0.9372228673	1.193253481	1.095651935	-1.198508469	1.490253481	1.392651935	-1.459794071
-0.2463333333	-0.2463333333	0.02671486693	0.05066666667	0.05066666667	-0.2345707349	0.3476666667	0.3476666667	-0.4958563368	0.6446666667	0.6446666667	-0.7571419387	0.9416666667	0.9416666667	-1.018427541	1.238666667	1.238666667	-1.279713142	1.535666667	1.535666667	-1.540998744
-0.2009201472	-0.1033186019	-0.05448980636	0.09607985281	0.1936813981	-0.3157754082	0.3930798528	0.4906813981	-0.5770610101	0.6900798528	0.7876813981	-0.838346612	0.9870798528	1.084681398	-1.099632214	1.284079853	1.381681398	-1.360917816	1.581079853	1.678681398	-1.622203418
-0.155506961	0.03969612963	-0.1356944796	0.141493039	0.3366961296	-0.3969800815	0.438493039	0.6336961296	-0.6582656834	0.735493039	0.9306961296	-0.9195512853	1.032493039	1.22769613	-1.180836887	1.329493039	1.52469613	-1.442122489	1.626493039	1.82169613	-1.703408091
-0.1100937749	0.1827108611	-0.2168991529	0.1869062251	0.4797108611	-0.4781847548	0.4839062251	0.7767108611	-0.7394703567	0.7809062251	1.073710861	-1.000755959	1.077906225	1.370710861	-1.26204156	1.374906225	1.667710861	-1.523327162	1.671906225	1.964710861	-1.784612764
-0.06468058876	0.3257255926	-0.2981038262	0.2323194112	0.6227255926	-0.5593894281	0.5293194112	0.9197255926	-0.82067503	0.8263194112	1.216725593	-1.081960632	1.123319411	1.513725593	-1.343246234	1.420319411	1.810725593	-1.604531836	1.717319411	2.107725593	-1.865817437
-0.01926740261	0.4687403241	-0.3793084995	0.2777325974	0.7657403241	-0.6405941014	0.5747325974	1.062740324	-0.9018797032	0.8717325974	1.359740324	-1.163165305	1.168732597	1.656740324	-1.424450907	1.465732597	1.953740324	-1.685736509	1.762732597	2.250740324	-1.947022111
0.02614578353	0.6117550556	-0.4605131728	0.3231457835	0.9087550556	-0.7217987746	0.6201457835	1.205755056	-0.9830843765	0.9171457835	1.502755056	-1.244369978	1.214145784	1.799755056	-1.50565558	1.511145784	2.096755056	-1.766941182	1.808145784	2.393755056	-2.028226784
0.07155896968	0.754769787	-0.5417178461	0.3685589697	1.051769787	-0.8030034479	0.6655589697	1.348769787	-1.06428905	0.9625589697	1.645769787	-1.325574652	1.25955897	1.942769787	-1.586860254	1.55655897	2.239769787	-1.848145855	1.85355897	2.536769787	-2.109431457
0.1169721558	0.8977845185	-0.6229225193	0.4139721558	1.194784519	-0.8842081212	0.7109721558	1.491784519	-1.145493723	1.007972156	1.788784519	-1.406779325	1.304972156	2.085784519	-1.668064927	1.601972156	2.382784519	-1.929350529	1.898972156	2.679784519	-2.190636131
0.162385342	1.04079925	-0.7041271926	0.459385342	1.33779925	-0.9654127945	0.756385342	1.63479925	-1.226698396	1.053385342	1.93179925	-1.487983998	1.350385342	2.22879925	-1.7492696	1.647385342	2.52579925	-2.010555202	1.944385342	2.82279925	-2.271840804
0.2077985281	1.183813981	-0.7853318659	0.5047985281	1.480813981	-1.046617468	0.8017985281	1.777813981	-1.30790307	1.098798528	2.074813981	-1.569188672	1.395798528	2.371813981	-1.830474273	1.692798528	2.668813981	-2.091759875	1.989798528	2.965813981	-2.353045477
0.2532117143	1.326828713	-0.8665365392	0.5502117143	1.623828713	-1.127822141	0.8472117143	1.920828713	-1.389107743	1.144211714	2.217828713	-1.650393345	1.441211714	2.514828713	-1.911678947	1.738211714	2.811828713	-2.172964549	2.035211714	3.108828713	-2.43425015
0.2986249004	1.469843444	-0.9477412125	0.5956249004	1.766843444	-1.209026814	0.8926249004	2.063843444	-1.470312416	1.1896249	2.360843444	-1.731598018	1.4866249	2.657843444	-1.99288362	1.7836249	2.954843444	-2.254169222	2.0806249	3.251843444	-2.515454824
0.3440380865	1.612858176	-1.028945886	0.6410380865	1.909858176	-1.290231488	0.9380380865	2.206858176	-1.55151709	1.235038087	2.503858176	-1.812802691	1.532038087	2.800858176	-2.074088293	1.829038087	3.097858176	-2.335373895	2.126038087	3.394858176	-2.596659497
0.3894512727	1.755872907	-1.110150559	0.6864512727	2.052872907	-1.371436161	0.9834512727	2.349872907	-1.632721763	1.280451273	2.646872907	-1.894007365	1.577451273	2.943872907	-2.155292967	1.874451273	3.240872907	-2.416578568	2.171451273	3.537872907	-2.67786417
0.4348644588	1.898887639	-1.191355232	0.7318644588	2.195887639	-1.452640834	1.028864459	2.492887639	-1.713926436	1.325864459	2.789887639	-1.975212038	1.622864459	3.086887639	-2.23649764	1.919864459	3.383887639	-2.497783242	2.216864459	3.680887639	-2.759068844
0.480277645	2.04190237	-1.272559906	0.777277645	2.33890237	-1.533845507	1.074277645	2.63590237	-1.795131109	1.371277645	2.93290237	-2.056416711	1.668277645	3.22990237	-2.317702313	1.965277645	3.52690237	-2.578987915	2.262277645	3.82390237	-2.840273517
0.5256908311	2.184917102	-1.353764579	0.8226908311	2.481917102	-1.615050181	1.119690831	2.778917102	-1.876335783	1.416690831	3.075917102	-2.137621385	1.713690831	3.372917102	-2.398906986	2.010690831	3.669917102	-2.660192588	2.307690831	3.966917102	-2.92147819
0.5711040173	2.327931833	-1.434969252	0.8681040173	2.624931833	-1.696254854	1.165104017	2.921931833	-1.957540456	1.462104017	3.218931833	-2.218826058	1.759104017	3.515931833	-2.48011166	2.056104017	3.812931833	-2.741397262	2.353104017	4.109931833	-3.002682863
0.6165172034	2.470946565	-1.516173925	0.9135172034	2.767946565	-1.777459527	1.210517203	3.064946565	-2.038745129	1.507517203	3.361946565	-2.300030731	1.804517203	3.658946565	-2.561316333	2.101517203	3.955946565	-2.822601935	2.398517203	4.252946565	-3.083887537];

count = 1;
for i = 1:3:21
    for j = 1:23
        trimcase(count).CL_HTail(j,1) = dataCLCLCM(j,i);
        trimcase(count).CL_Total(j,1) = dataCLCLCM(j,i+1);
        trimcase(count).CM_atCG(j,1) = dataCLCLCM(j,i+2);        
    end
    trimcase(count).i_H = labelCLCLCM(count);
    count = count + 1;
end

%% Design-target CL values
CLdesign = [1.249395988
    0.3885070089
    0.7539370098];


%% Generate figure
figure(12)
for i = 1:7
    plot(trimcase(i).CL_Total(:,1),trimcase(i).CM_atCG(:,1));
    hold on
end
legend(['i_H = ',num2str(trimcase(1).i_H)],...
    ['i_H = ',num2str(trimcase(2).i_H)],...
    ['i_H = ',num2str(trimcase(3).i_H)],...
    ['i_H = ',num2str(trimcase(4).i_H)],...
    ['i_H = ',num2str(trimcase(5).i_H)],...
    ['i_H = ',num2str(trimcase(6).i_H)],...
    ['i_H = ',num2str(trimcase(7).i_H)])
grid on;
title('C_{M_{CG}} vs. C_L for varying tail-setting angle')
xlabel('C_L')
ylabel('C_{M_{CG}}')
yline(0,'--k','linewidth',lw);


improvePlot()




